<div id="alert-message" class="empty:hidden"></div>

<form
  hx-post="/auth/update_data"
  hx-swap="outerHTML"
  hx-target="#alert-message">
  <div id="user-data-edit-box" style="display: none;" class="md:col-span-1 h-fit border-2 border-black bg-white shadow-[4px_4px_0_0_#000]">
    <div class="border-b-2 border-black bg-gray-100 p-4 flex justify-between items-center">
      <h3 class="font-bold text-lg uppercase flex items-center gap-2"> Personal Data </h3>

      <div>
        <button
          id="submit"
          class="self-end cursor-pointer border-2 border-black px-5 py-3 font-bold text-black shadow-[4px_4px_0_0] transition-all hover:shadow-[2px_2px_0_0] active:translate-x-[2px] active:translate-y-[2px] active:shadow-none focus:outline-none bg-green-50 hover:bg-green-300">
          Submit
        </button>
        <button
          id="cancel-button"
          class="self-end cursor-pointer border-2 border-black px-5 py-3 font-bold text-black shadow-[4px_4px_0_0] transition-all hover:shadow-[2px_2px_0_0] active:translate-x-[2px] active:translate-y-[2px] active:shadow-none focus:outline-none bg-red-50 hover:bg-red-300">
          Cancel
        </button>
      </div>
    </div>
    
    <dl class="divide-y-2 divide-black">

      <div class="p-4">
        <dt class="text-xs font-bold text-gray-500 uppercase"> Username </dt>
        <dd>
          <!-- Modified Username partial -->
          <input
            type="text"
            placeholder="Username"
            value="<%- locals.username %>"
            class="mt-0.5 mb-0.5 w-full border-2 border-black py-2 pe-10 pl-3 shadow-[4px_4px_0_0] focus:ring-2 focus:ring-yellow-300 sm:text-sm outline-none transition-all"
            name="username" id="username-input"
            required>
        </dd>
      </div>

      <div class="p-4">
          <dt class="text-xs font-bold text-gray-500 uppercase"> Email </dt>
          <dd>
            <div class="relative mt-0.5">
              <input 
                type="email" 
                placeholder="email@example.com"
                value="<%- locals.email %>"
                class="w-full border-2 border-black py-2 pe-10 pl-3 shadow-[4px_4px_0_0] focus:ring-2 focus:ring-yellow-300 sm:text-sm outline-none transition-all"
                name="email" id="email-input"
                required>

              <span class="absolute top-1/2 right-1 -translate-y-1/2 grid w-8 h-8 place-content-center bg-black text-white pointer-events-none">      
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" fill="currentColor" class="w-4 h-4">
                  <path fill-rule="evenodd" d="M11.89 4.111a5.5 5.5 0 1 0 0 7.778.75.75 0 1 1 1.06 1.061A7 7 0 1 1 15 8a2.5 2.5 0 0 1-4.083 1.935A3.5 3.5 0 1 1 11.5 8a1 1 0 0 0 2 0 5.48 5.48 0 0 0-1.61-3.889ZM10 8a2 2 0 1 0-4 0 2 2 0 0 0 4 0Z" clip-rule="evenodd"></path>
                </svg>
              </span>
            </div>
          </dd>
      </div>

      <div class="p-4">
        <dt class="text-xs font-bold text-gray-500 uppercase"> Is profile public </dt>
        <dd class="inline-flex items-center gap-1">
          <input 
            type="checkbox"
            value="true"
            class="m-2 size-6 border-2 border-black shadow-[2px_2px_0_0] shadow-black checked:bg-black focus:ring-2 focus:ring-black"
            id="is-public-input" name="is_public"
            <% if(locals.is_public){ %> checked <% } %>>

          <span class="font-semibold"> Make Profile Public </span>
        </dd>
      </div>
      
      <div class="p-4 bg-yellow-50">
        <dt class="text-xs font-bold text-gray-500 uppercase"> Password </dt>
        <dd class="text-lg font-bold"> •••••••••• <dd>
      </div>
    </dl>
  </div>
</form>

<script>
  function togglePersonalData() {
    document.getElementById("username-input").value = "<%- locals.username %>";
    document.getElementById("email-input").value = "<%- locals.email %>";
    
    document.getElementById("is-public-input").checked = <%- locals.is_public %> ;
    
/*     document.getElementById("pass-input").value = "";
    document.getElementById("rep-pass-input").value = ""; */
    
    var x = document.getElementById("user-data-box");
    if (x.style.display === "none") {
      x.style.display = "block";
    } else {
      x.style.display = "none";
    }
    var x = document.getElementById("user-data-edit-box");
    if (x.style.display === "none") {
      x.style.display = "block";
    } else {
      x.style.display = "none";
    }
  }
  
  document.getElementById("data-button").onclick=togglePersonalData;
  document.getElementById("cancel-button").onclick=togglePersonalData;
  
  const tabs = document.getElementsByClassName("tabcontent");
  tablinks = document.getElementsByClassName("tablink");
  function tabClick(evt, id){
    for (i = 0; i < tabs.length; i++) {
      tabs[i].style.display = "none";
    }
    document.getElementById(id).style.display = "block";
    
    for (i = 0; i < tablinks.length; i++) {
      tablinks[i].className = tablinks[i].className.replace(" active-tablink", "");
    }
    evt.currentTarget.className += " active-tablink";
  }
</script>

<style>
button.active-tablink {
  border-color: black;
  background-color: var(--color-yellow-300); /* bg-yellow-300 */
}
</style>
